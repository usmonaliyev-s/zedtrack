{% extends 'base.html' %}

{% block content %}

<div class="content-page">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="d-flex flex-wrap flex-wrap align-items-center justify-content-between mb-4">
                    <div>
                        <h4 class="mb-3">Course: {{ course.course_name }}</h4>
                    </div>
                    <div>
                        {% if role == "admin" %}
                        <a href="{% url 'edit-course' course.id %}" class="btn btn-primary add-list">
                            Edit Details
                        </a>
                        {% endif %}
                        <a href="{% url 'selected-course' course.id %}" class="btn btn-primary add-list">
                            Mark Attendance
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-12">
                <div class="row" style="position: relative; top: -20px;">
                    <div style="height: 130px;" class="col-lg-4 col-md-3">
                        <div class="card card-block card-stretch card-height" style="background-color: var(--main-color); ;">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-4 card-total-sale">
                                    <div class="icon iq-icon-box-2 bg-info-light" style="background-color: white !important;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 1024 768">
                                            <path
                                                fill="var(--main-color)"
                                                d="M1024 736q0 13-9.5 22.5T992 768t-22.5-9.5T960 736V315L607 492q-40 20-95 20t-95-20L39 303Q0 283 0 255.5T39 209L417 20q40-20 95-20t95 20l378 189q34 17 38 42q1 1 1 4v481zM639 556l193-97v141q0 43-93.5 73.5T512 704t-226.5-30.5T192 600V459l193 97q40 20 127 20t127-20z"
                                            ></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <p class="mb-2" style="color: white;">Students</p>
                                        <h4 style="color: white;">{{ students.count }}</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="height: 130px;" class="col-lg-4 col-md-3">
                        <div class="card card-block card-stretch card-height" style="background-color: var(--main-color); ;">
                            <div class="card-body">
                                <a href="{% url 'teacher-details' course.course_teacher_id %}">
                                    <div class="d-flex align-items-center mb-4 card-total-sale">
                                        <div class="icon iq-icon-box-2 bg-success-light" style="background-color: white !important;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" stroke="var(--main-color)" stroke-width="0.5" viewBox="0 0 20 20">
                                                <path
                                                    fill="var(--main-color)"
                                                    d="M8.75 3.75a2.75 2.75 0 1 0-5.5 0a2.75 2.75 0 0 0 5.5 0Zm-4.5 0a1.75 1.75 0 1 1 3.5 0a1.75 1.75 0 0 1-3.5 0ZM2.5 7.5h4.183c-.164.31-.286.646-.358 1H2.5A.5.5 0 0 0 2 9v.5c0 1.26 1.099 2.614 3.096 2.93c-.322.22-.59.513-.781.854C2.205 12.713 1 11.087 1 9.5V9a1.5 1.5 0 0 1 1.5-1.5Zm5.379 0c.504-.61 1.267-1 2.121-1a2.744 2.744 0 0 1 2.646 2a2.753 2.753 0 0 1-3.893 3.202A2.75 2.75 0 0 1 7.88 7.5Zm.54 1a1.75 1.75 0 1 0 3.164 1.5a1.75 1.75 0 0 0-3.165-1.5Zm7.266 4.784a2.513 2.513 0 0 0-.781-.853C16.9 12.114 18 10.759 18 9.5V9a.5.5 0 0 0-.5-.5h-3.825a3.726 3.726 0 0 0-.357-1H17.5A1.5 1.5 0 0 1 19 9v.5c0 1.587-1.206 3.212-3.315 3.784Zm-1.198.087A1.493 1.493 0 0 0 13.5 13h-7A1.496 1.496 0 0 0 5 14.5v.5c0 1.971 1.86 4 5 4c3.14 0 5-2.029 5-4v-.5c0-.45-.198-.854-.513-1.13ZM6 14.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v.5c0 1.438-1.432 3-4 3s-4-1.562-4-3v-.5ZM14 1a2.75 2.75 0 1 1 0 5.5A2.75 2.75 0 0 1 14 1Zm0 1a1.75 1.75 0 1 0 0 3.5A1.75 1.75 0 0 0 14 2Z"
                                                ></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <p class="mb-2" style="color: white;">Teacher</p>
                                            <h4 style="color: white;">{{ course.course_teacher }}</h4>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div style="height: 130px;" class="col-lg-4 col-md-3">
                        <div class="card card-block card-stretch card-height" style="background-color: var(--main-color); ;">
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-4 card-total-sale">
                                    <div class="icon iq-icon-box-2 bg-danger-light" style="background-color: white !important;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24">
                                            <path fill="var(--main-color)" d="M19 3h-2v6.5l-3-2.25l-3 2.25V3H5v18h14V3Zm-6 0v2.5l1-.75l1 .75V3h-2Zm8 20H3V1h18v22Z" />
                                        </svg>
                                    </div>
                                    <div>
                                        <p class="mb-2" style="color: white;">Courses Days</p>
                                        <h4 style="color: white;">{% for day in course.days %}{{ day }}, {% endfor %}</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-lg-12">
            <h4 class="mb-3">Students</h4>

                <div class="table-responsive rounded mb-3">
                    <table class="data-table table mb-0 tbl-server-info">
                        <thead class="bg-white text-uppercase">
                            <tr>
                                <th style="text-align: left">Name</th>
                                <th style="text-align: left">Attendance Rate</th>
                                <th style="text-align: left">Registered Date</th>
                                <th style="text-align: left">Gender</th>
                                <th style="text-align: left"></th>
                            </tr>
                        </thead>
                        <tbody class="ligth-body">
                            {% for student in students %}
                            <tr style="background-color: var(--background-color);">
                                <td style="text-align: start"><a style="background-color: var(--background-color); color: var(--text-color);" href="{% url 'student-details' student.id %}">{{ student.first_name }} {{ student.last_name }}</a></td>
                                <td style="background-color: var(--background-color); color: var(--text-color); text-align: left">{{ student.attendance_rate|floatformat:2 }}%</td>
                                <td style="background-color: var(--background-color); color: var(--text-color); text-align: left">{{ student.registration_date }}</td>
                                <td style="background-color: var(--background-color); color: var(--text-color); text-align: left">{{ student.gender }}</td>
                                <td style="text-align: left">
                                    <a href="{% url 'edit-student' student.id %}" style="display: inline;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="var(--main-color)" class="bi bi-pen" viewBox="0 0 16 16">
                                            <path
                                                d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"
                                            ></path>
                                        </svg>
                                    </a>
                                    <a href="{% url 'delete-confirmation-student' student.id %}" style="display: inline;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-archive" viewBox="0 0 16 16">
                                            <path
                                                d="M0 2a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1v7.5a2.5 2.5 0 0 1-2.5 2.5h-9A2.5 2.5 0 0 1 1 12.5V5a1 1 0 0 1-1-1V2zm2 3v7.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5V5H2zm13-3H1v2h14V2zM5 7.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5z"
                                            ></path>
                                        </svg>
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-lg-12 mb-4">
                <h4 class="mb-3">Course Calendar — {{ month_name }} {{ year }}</h4>
                <div class="table-responsive">
                    <table class="table table-bordered text-center" style="color: var(--text-color);">
                        <thead class="thead-light">
                            <tr>
                                <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for week in calendar_weeks %}
                                <tr>
                                    {% for day, is_course_day in week %}
                                        <td style="
                                            padding: 15px;
                                            {% if day.month != today.month %}
                                                color: gray;
                                            {% elif is_course_day %}
                                                background-color: var(--main-color);
                                                color: white;
                                                font-weight: bold;
                                                border: 2px solid var(--main-color);
                                            {% endif %}
                                        ">
                                            {{ day.day }}
                                        </td>
                                    {% endfor %}
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
        <!-- Page end  -->
    </div>
</div>

{% endblock %}